version: "3"
services:
        redis:
                image: "redis:alpine"
                expose:
                        - 6379
        server:
                build: ./server
                image: heaty566/myquiz-v2-server:latest
                expose:
                        - 4000
                env_file:
                        - ./data/config/server.env
        client:
                build: "./client"
                image: heaty566/myquiz-v2-client:latest
                expose:
                        - 3000
        certbot:
                image: certbot/certbot
                volumes:
                        - ./data/certbot/conf:/etc/letsencrypt
                        - ./data/certbot/www:/var/www/certbot
        nginx:
                image: nginx:1.15-alpine
                ports:
                        - 80:80
                        - 443:443
                volumes:
                        - ./data/certbot/conf:/etc/letsencrypt
                        - ./data/certbot/www:/var/www/certbot
                        - ./data/nginx:/etc/nginx/conf.d
